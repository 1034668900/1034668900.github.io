<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.61">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="/logo.png"><title>Vue2数据响应式原理 | FengCh</title><meta name="description" content="欢迎来到我的博客网站 !">
    <link rel="preload" href="/assets/style-c8afb295.css" as="style"><link rel="stylesheet" href="/assets/style-c8afb295.css">
    <link rel="modulepreload" href="/assets/app-24212b55.js"><link rel="modulepreload" href="/assets/framework-6700cb35.js"><link rel="modulepreload" href="/assets/Vue2数据响应式原理.html-29bb7216.js"><link rel="modulepreload" href="/assets/Vue2数据响应式原理.html-29c22280.js"><link rel="prefetch" href="/assets/index.html-b31938f6.js" as="script"><link rel="prefetch" href="/assets/index.html-1264f517.js" as="script"><link rel="prefetch" href="/assets/Ajax使用.html-196206b6.js" as="script"><link rel="prefetch" href="/assets/Axios简介.html-00c37377.js" as="script"><link rel="prefetch" href="/assets/Fetch简介.html-7120555d.js" as="script"><link rel="prefetch" href="/assets/Web Workers.html-e840b6c2.js" as="script"><link rel="prefetch" href="/assets/事件循环.html-9e6ed603.js" as="script"><link rel="prefetch" href="/assets/响应式布局.html-2fe50644.js" as="script"><link rel="prefetch" href="/assets/网页渲染.html-179c37e6.js" as="script"><link rel="prefetch" href="/assets/计算机网络.html-49f2eef8.js" as="script"><link rel="prefetch" href="/assets/Promise.html-6663e57a.js" as="script"><link rel="prefetch" href="/assets/一图了解原型链.html-0ea716ff.js" as="script"><link rel="prefetch" href="/assets/浅拷贝和深拷贝.html-11d6edaa.js" as="script"><link rel="prefetch" href="/assets/如何处理后端一次返回大量数据.html-37690ffc.js" as="script"><link rel="prefetch" href="/assets/git基础知识.html-86dcadf3.js" as="script"><link rel="prefetch" href="/assets/webpack.html-8f7b1f4e.js" as="script"><link rel="prefetch" href="/assets/Vue2.html-3b036ad5.js" as="script"><link rel="prefetch" href="/assets/Vue3.html-6af41070.js" as="script"><link rel="prefetch" href="/assets/404.html-f9875e7b.js" as="script"><link rel="prefetch" href="/assets/index.html-c2d5331a.js" as="script"><link rel="prefetch" href="/assets/index.html-cbaf4539.js" as="script"><link rel="prefetch" href="/assets/Ajax使用.html-fa06058f.js" as="script"><link rel="prefetch" href="/assets/Axios简介.html-dd12d507.js" as="script"><link rel="prefetch" href="/assets/Fetch简介.html-e96ee56c.js" as="script"><link rel="prefetch" href="/assets/Web Workers.html-abb0189f.js" as="script"><link rel="prefetch" href="/assets/事件循环.html-7cf8b756.js" as="script"><link rel="prefetch" href="/assets/响应式布局.html-65b251c6.js" as="script"><link rel="prefetch" href="/assets/网页渲染.html-780bcde2.js" as="script"><link rel="prefetch" href="/assets/计算机网络.html-44161ece.js" as="script"><link rel="prefetch" href="/assets/Promise.html-f367c9f5.js" as="script"><link rel="prefetch" href="/assets/一图了解原型链.html-6ed1d1a9.js" as="script"><link rel="prefetch" href="/assets/浅拷贝和深拷贝.html-17a719b8.js" as="script"><link rel="prefetch" href="/assets/如何处理后端一次返回大量数据.html-9c8ef2a2.js" as="script"><link rel="prefetch" href="/assets/git基础知识.html-14c0d5ce.js" as="script"><link rel="prefetch" href="/assets/webpack.html-90758e0e.js" as="script"><link rel="prefetch" href="/assets/Vue2.html-436678e3.js" as="script"><link rel="prefetch" href="/assets/Vue3.html-59526964.js" as="script"><link rel="prefetch" href="/assets/404.html-85eb4967.js" as="script"><link rel="prefetch" href="/assets/Home-cc057463.js" as="script"><link rel="prefetch" href="/assets/HomeButton-e7f0fea2.js" as="script"><link rel="prefetch" href="/assets/SelfIntro-03d395f3.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="/logo.png" alt="FengCh"><span class="site-name can-hide">FengCh</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="myProjects"><span class="title">myProjects</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="myProjects"><span class="title">myProjects</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="external-link" href="https://github.com/1034668900/Lyrics-scrolling-effect.git" rel="noopener noreferrer" target="_blank" aria-label="歌词滚动效果"><!--[--><!--]--> 歌词滚动效果 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://github.com/1034668900/ShoppingCart-Effect.git" rel="noopener noreferrer" target="_blank" aria-label="原生js面向对象编程思想实现购物车效果"><!--[--><!--]--> 原生js面向对象编程思想实现购物车效果 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://gitee.com/Feng_Ch/uni-shop.git" rel="noopener noreferrer" target="_blank" aria-label="购物商城微信小程序"><!--[--><!--]--> 购物商城微信小程序 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://github.com/1034668900/shopping-mall-project.git" rel="noopener noreferrer" target="_blank" aria-label="购物商城前台项目"><!--[--><!--]--> 购物商城前台项目 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="JavaScript"><span class="title">JavaScript</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="JavaScript"><span class="title">JavaScript</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/guide/blogs/JavaScript/浅拷贝和深拷贝.md" class="" aria-label="浅拷贝和深拷贝"><!--[--><!--]--> 浅拷贝和深拷贝 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/blogs/JavaScript/Promise.md" class="" aria-label="Promise"><!--[--><!--]--> Promise <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/blogs/JavaScript/一图了解原型链.md" class="" aria-label="原型链图示"><!--[--><!--]--> 原型链图示 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Vue"><span class="title">Vue</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Vue"><span class="title">Vue</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/guide/blogs/vue/Vue2.md" class="" aria-label="Vue2"><!--[--><!--]--> Vue2 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/blogs/vue/Vue3.md" class="" aria-label="Vue3"><!--[--><!--]--> Vue3 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/blogs/vue/Vue2数据响应式原理.md" class="" aria-label="Vue2数据响应式原理"><!--[--><!--]--> Vue2数据响应式原理 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Tools"><span class="title">Tools</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Tools"><span class="title">Tools</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/guide/blogs/tools/webpack.md" class="" aria-label="webpack"><!--[--><!--]--> webpack <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/blogs/tools/git基础知识.md" class="" aria-label="git"><!--[--><!--]--> git <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Problem"><span class="title">Problem</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Problem"><span class="title">Problem</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/guide/blogs/problem/如何处理后端一次返回大量数据.md" class="" aria-label="如何处理后端返回大量数据"><!--[--><!--]--> 如何处理后端返回大量数据 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Browser"><span class="title">Browser</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Browser"><span class="title">Browser</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/guide/blogs/browser/Ajax使用.md" class="" aria-label="Ajax使用"><!--[--><!--]--> Ajax使用 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/blogs/browser/Fetch简介.md" class="" aria-label="Fetch简介"><!--[--><!--]--> Fetch简介 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/blogs/browser/Axios简介.md" class="" aria-label="Axios简介"><!--[--><!--]--> Axios简介 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/blogs/browser/事件循环.md" class="" aria-label="事件循环"><!--[--><!--]--> 事件循环 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/blogs/browser/计算机网络.md" class="" aria-label="计算机网络"><!--[--><!--]--> 计算机网络 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/blogs/browser/网页渲染.md" class="" aria-label="网页渲染"><!--[--><!--]--> 网页渲染 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/blogs/browser/响应式布局.md" class="" aria-label="响应式布局"><!--[--><!--]--> 响应式布局 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/blogs/browser/Web Workers.md" class="" aria-label="Web Workers"><!--[--><!--]--> Web Workers <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/1034668900/1034668900.github.io.git" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="Search" autocomplete="off" spellcheck="false" value><!----></form></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/" class="" aria-label="Home"><!--[--><!--]--> Home <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="myProjects"><span class="title">myProjects</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="myProjects"><span class="title">myProjects</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="external-link" href="https://github.com/1034668900/Lyrics-scrolling-effect.git" rel="noopener noreferrer" target="_blank" aria-label="歌词滚动效果"><!--[--><!--]--> 歌词滚动效果 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://github.com/1034668900/ShoppingCart-Effect.git" rel="noopener noreferrer" target="_blank" aria-label="原生js面向对象编程思想实现购物车效果"><!--[--><!--]--> 原生js面向对象编程思想实现购物车效果 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://gitee.com/Feng_Ch/uni-shop.git" rel="noopener noreferrer" target="_blank" aria-label="购物商城微信小程序"><!--[--><!--]--> 购物商城微信小程序 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://github.com/1034668900/shopping-mall-project.git" rel="noopener noreferrer" target="_blank" aria-label="购物商城前台项目"><!--[--><!--]--> 购物商城前台项目 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="JavaScript"><span class="title">JavaScript</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="JavaScript"><span class="title">JavaScript</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/guide/blogs/JavaScript/浅拷贝和深拷贝.md" class="" aria-label="浅拷贝和深拷贝"><!--[--><!--]--> 浅拷贝和深拷贝 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/blogs/JavaScript/Promise.md" class="" aria-label="Promise"><!--[--><!--]--> Promise <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/blogs/JavaScript/一图了解原型链.md" class="" aria-label="原型链图示"><!--[--><!--]--> 原型链图示 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Vue"><span class="title">Vue</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Vue"><span class="title">Vue</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/guide/blogs/vue/Vue2.md" class="" aria-label="Vue2"><!--[--><!--]--> Vue2 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/blogs/vue/Vue3.md" class="" aria-label="Vue3"><!--[--><!--]--> Vue3 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/blogs/vue/Vue2数据响应式原理.md" class="" aria-label="Vue2数据响应式原理"><!--[--><!--]--> Vue2数据响应式原理 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Tools"><span class="title">Tools</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Tools"><span class="title">Tools</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/guide/blogs/tools/webpack.md" class="" aria-label="webpack"><!--[--><!--]--> webpack <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/blogs/tools/git基础知识.md" class="" aria-label="git"><!--[--><!--]--> git <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Problem"><span class="title">Problem</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Problem"><span class="title">Problem</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/guide/blogs/problem/如何处理后端一次返回大量数据.md" class="" aria-label="如何处理后端返回大量数据"><!--[--><!--]--> 如何处理后端返回大量数据 <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Browser"><span class="title">Browser</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Browser"><span class="title">Browser</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/guide/blogs/browser/Ajax使用.md" class="" aria-label="Ajax使用"><!--[--><!--]--> Ajax使用 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/blogs/browser/Fetch简介.md" class="" aria-label="Fetch简介"><!--[--><!--]--> Fetch简介 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/blogs/browser/Axios简介.md" class="" aria-label="Axios简介"><!--[--><!--]--> Axios简介 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/blogs/browser/事件循环.md" class="" aria-label="事件循环"><!--[--><!--]--> 事件循环 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/blogs/browser/计算机网络.md" class="" aria-label="计算机网络"><!--[--><!--]--> 计算机网络 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/blogs/browser/网页渲染.md" class="" aria-label="网页渲染"><!--[--><!--]--> 网页渲染 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/blogs/browser/响应式布局.md" class="" aria-label="响应式布局"><!--[--><!--]--> 响应式布局 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/guide/blogs/browser/Web Workers.md" class="" aria-label="Web Workers"><!--[--><!--]--> Web Workers <!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/1034668900/1034668900.github.io.git" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">Vue2数据响应式原理 <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/guide/blogs/vue/Vue2%E6%95%B0%E6%8D%AE%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86.html#object-defineproperty-方法介绍" class="router-link-active router-link-exact-active sidebar-item" aria-label="Object.defineProperty（  ）方法介绍"><!--[--><!--]--> Object.defineProperty（  ）方法介绍 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/blogs/vue/Vue2%E6%95%B0%E6%8D%AE%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86.html#自定义-definereactive-方法" class="router-link-active router-link-exact-active sidebar-item" aria-label="自定义 defineReactive( ) 方法"><!--[--><!--]--> 自定义 defineReactive( ) 方法 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/blogs/vue/Vue2%E6%95%B0%E6%8D%AE%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86.html#对象属性侦测实现" class="router-link-active router-link-exact-active sidebar-item" aria-label="对象属性侦测实现"><!--[--><!--]--> 对象属性侦测实现 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/blogs/vue/Vue2%E6%95%B0%E6%8D%AE%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86.html#数组属性侦测的完善" class="router-link-active router-link-exact-active sidebar-item" aria-label="数组属性侦测的完善"><!--[--><!--]--> 数组属性侦测的完善 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/blogs/vue/Vue2%E6%95%B0%E6%8D%AE%E5%93%8D%E5%BA%94%E5%BC%8F%E5%8E%9F%E7%90%86.html#依赖收集" class="router-link-active router-link-exact-active sidebar-item" aria-label="依赖收集"><!--[--><!--]--> 依赖收集 <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="vue2数据响应式原理" tabindex="-1"><a class="header-anchor" href="#vue2数据响应式原理" aria-hidden="true">#</a> Vue2数据响应式原理</h1><h2 id="object-defineproperty-方法介绍" tabindex="-1"><a class="header-anchor" href="#object-defineproperty-方法介绍" aria-hidden="true">#</a> Object.defineProperty（ ）方法介绍</h2><ul><li><p><code>Object.defineProperty(obj, prop, descriptor)</code>方法会直接在一个对象上定义一个新属性，或者修改一个对象的现有属性，并返回此对象</p></li><li><p>参数：</p><ol><li>obj：要定义的对象</li><li>prop： 定义的属性</li><li>descriptor： 要定义或修改的属性的描述符</li></ol></li><li><p><strong>存在问题</strong> : <code>getter、setter</code>想实现<strong>数据修改必须设置一个中转变量</strong></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>
<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> temp <span class="token operator">=</span> <span class="token number">9</span><span class="token punctuation">;</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token comment">// 可枚举</span>
  <span class="token literal-property property">enumerable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">configurable</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;get被访问&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> temp<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">set</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;set被访问&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    temp <span class="token operator">=</span> newValue<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> obj<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//1  9</span>
obj<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span> obj<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//2  10</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>**解决办法：**自定义<code>defineReactive（ ）</code>方法，利用闭包实现</p></li></ul><h2 id="自定义-definereactive-方法" tabindex="-1"><a class="header-anchor" href="#自定义-definereactive-方法" aria-hidden="true">#</a> 自定义 defineReactive( ) 方法</h2><ul><li>外部函数变量<code>val</code>在内部函数中使用，从而实现一个<strong>闭包</strong>环境</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">defineReactive</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span>key<span class="token punctuation">,</span>val</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span>key<span class="token punctuation">,</span><span class="token punctuation">{</span>
        <span class="token comment">// 可枚举</span>
        <span class="token literal-property property">enumerable</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token literal-property property">configurable</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> val
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">set</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>val <span class="token operator">!==</span> newValue<span class="token punctuation">)</span><span class="token punctuation">{</span>
                val <span class="token operator">=</span> newValue
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token function">defineReactive</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">&#39;a&#39;</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span> obj<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//1 200</span>
obj<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">,</span> obj<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//2 10</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="对象属性侦测实现" tabindex="-1"><a class="header-anchor" href="#对象属性侦测实现" aria-hidden="true">#</a> 对象属性侦测实现</h2><ul><li><p><strong>本质</strong>：利用递归侦测对象的全部属性</p></li><li><p>图示</p><p><img src="/images/vue2/vue2响应式原理/递归侦测数据.jpg" alt="递归侦测数据"></p></li><li><p><strong>函数解释：</strong></p><ol><li><strong>observe( )函数</strong>：工具函数，用于检测一个对象是否为<strong>Observe类</strong>的<strong>实例</strong>（是否含有__ob__属性）</li><li><strong>Observer( )类</strong>：用于将一个普通的<strong>object</strong>对象的每个属性都转换为<strong>响应式属性</strong>，同时为每个属性都添加一个<code>__ob__</code>属性，其值为<code>Observer( )类的实例</code>(<strong>注意：<strong>构造函数中的</strong>this</strong>是<strong>Observer</strong>的<strong>实例</strong>)</li><li><strong>defineReactive( )函数</strong>：将一个对象的某个属性（旧属性或新属性）设置为响应式数据</li></ol></li><li><p><strong>注意事项：</strong></p><ol><li><strong>defineReactive( )<strong>函数中要对设置的属性值value要调用</strong>observe</strong>进行检测是否含有<code>__ob__</code>,而且当属性被修改时，也要对setter的中的<strong>newValue</strong>用<strong>observe</strong>进行检测(因为赋的新值<strong>newValue</strong>也可能会是一个<strong>对象</strong>)</li><li><strong>defineReactive( )<strong>中的</strong>childOb</strong>在当前阶段没什么用，但是后续会使用到</li><li>此时的<strong>数据侦测</strong>还不能处理<strong>数组</strong></li></ol></li><li><p><strong>具体实现：</strong></p><ol><li><p><strong>defineReactive( )函数</strong></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> observe <span class="token keyword">from</span> <span class="token string">&quot;./observe&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">defineReactive</span><span class="token punctuation">(</span><span class="token parameter">data<span class="token punctuation">,</span>key<span class="token punctuation">,</span>value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>arguments<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        value <span class="token operator">=</span> data<span class="token punctuation">[</span>key<span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;我是defineReactive&quot;</span><span class="token punctuation">,</span>key<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 为属性定义属性值时也要对其检测是否含有__ob__属性</span>
    <span class="token keyword">let</span> childOb <span class="token operator">=</span> <span class="token function">observe</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span>key<span class="token punctuation">,</span><span class="token punctuation">{</span>
        <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;get属性被访问了&quot;</span><span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> value
        <span class="token punctuation">}</span><span class="token punctuation">,</span>

        <span class="token function">set</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;set属性被访问,有人修改数据了,值为&quot;</span><span class="token punctuation">,</span>newValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
            value <span class="token operator">=</span> newValue
            <span class="token comment">// 修改值时也要对修改的新值进行检测</span>
            childOb <span class="token operator">=</span> <span class="token function">observe</span><span class="token punctuation">(</span>newValue<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>observe( )函数</strong></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> Observer <span class="token keyword">from</span> <span class="token string">&quot;./Observer&quot;</span>

<span class="token comment">// 用于检测一个对象是否含有__ob__属性</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">observe</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 检测是否为object对象</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> obj <span class="token operator">!==</span> <span class="token string">&#39;object&#39;</span><span class="token punctuation">)</span><span class="token keyword">return</span>
    <span class="token comment">// 定义ob存储__ob__属性值(是Observer类的实例)</span>
    <span class="token keyword">let</span> ob
    <span class="token comment">// 检测是否含有__ob__属性</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> obj<span class="token punctuation">.</span>__ob__ <span class="token operator">!==</span> <span class="token string">&#39;undefined&#39;</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// 有__ob__属性</span>
        ob <span class="token operator">=</span> obj<span class="token punctuation">.</span>__ob__
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
        <span class="token comment">// 没有__ob__属性</span>
        ob <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Observer</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> ob
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>Observer( )类</strong></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">//目的： 用于将一个普通的object对象的全部属性转换为响应式数据</span>
<span class="token keyword">import</span> defineReactive <span class="token keyword">from</span> <span class="token string">&quot;./defineReactive&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> def <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./utils&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Observer</span><span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;我是Observer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 为obj添加__ob__属性，值为Observer类的实例（this）,并不可枚举</span>
        <span class="token function">def</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">&quot;__ob__&quot;</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">walk</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 遍历</span>
    <span class="token function">walk</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> item <span class="token keyword">in</span> obj<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">// 将属性转换为响应式</span>
            <span class="token function">defineReactive</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span>item<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol></li></ul><h2 id="数组属性侦测的完善" tabindex="-1"><a class="header-anchor" href="#数组属性侦测的完善" aria-hidden="true">#</a> 数组属性侦测的完善</h2><ul><li><p><strong>存在问题</strong>：上述侦测没有对数组类型进行处理，因此数组类型的数据还不能完成侦测</p></li><li><p><strong>实现思路：</strong></p><ul><li><p>将数组的七个方法进行重写，使其能够被侦测，<strong>特别注意</strong>需要修改数组对象的原型链，使其优先使用重写后的方法</p></li><li><p>图示</p><p><img src="/images/vue2/vue2响应式原理/数组侦测.jpg" alt=""></p></li></ul></li><li><p><strong>注意事项：</strong></p><ol><li><strong>arrayMethods</strong>是以<strong>Array.prototype</strong>为<strong>原型</strong>创建的对象，因此要使用API<code>const arrayMethods = Object.create(Array.prototype)</code>,同时该方法要<strong>暴露</strong>（在<strong>Observer</strong>中会引入使用）</li><li><strong>重写</strong>数组方法时，需要<strong>备份原生的方法</strong>来<strong>对数据进行修改</strong>，<strong>重写的目的</strong>只是为了使该操作能被<strong>侦测</strong>到</li><li><strong>Observer</strong>需要对<strong>obj的类型</strong>进行<strong>判断</strong>，如果是一个数组（<code>Array.isArray(obj)</code>）,则需要调用<strong>针对数组类型</strong>进行<strong>响应式转换</strong>的<strong>自定义</strong>函数<strong>observeArray(obj)</strong></li><li>一定要注意<strong>push、unshift、splice</strong>可以添加<strong>新项</strong>，因此也要对它们添加的新项进行<strong>observe</strong>检测</li><li>处理<strong>push、unshift、splice</strong>时需要拿到数组对象的**<code>__ob__</code>对应的实例对象**，因为在该实例对象身上有<strong>Observer</strong>中定义的<code>observeArray( )</code>方法</li><li>需要创建一个数组对象<strong>insertItems</strong> 用于存储<strong>数组方法</strong>导致的<strong>添加的新项</strong>，后续根据该对象<strong>是否为空</strong>来选择性的<strong>调用ob</strong>身上的<strong>observeArray</strong>方法进行<strong>检测</strong></li><li>处理<strong>splice添加新项</strong>的参数时，<strong>splice</strong>的<strong>使用语法</strong>为：<code>splice(下标，个数，添加的新项)</code>,因此这种情况我们要拿到添加的新项时需要将<strong>arguments</strong>进行数组分割，而<strong>arguments</strong>是一个<strong>伪数组</strong>，不具有<strong>slice</strong>方法，因此在使用前先用<strong>扩展运算符</strong>将其<strong>转换为一个数组</strong>存储<code>args = [...arguments]</code>，再利用slice分割数组拿到<strong>添加的新项</strong><code>insertItems = Arguments.slice(2)</code></li></ol></li><li><p><strong>具体实现</strong></p><ul><li>array.js</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> def <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./utils&quot;</span>

<span class="token comment">// 备份数组原型对象的方法</span>
<span class="token keyword">const</span> arrayPrototype <span class="token operator">=</span> <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype

<span class="token keyword">const</span> methodNames <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">&#39;push&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;pop&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;shift&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;unshift&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;splice&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;sort&#39;</span><span class="token punctuation">,</span>
    <span class="token string">&#39;reverse&#39;</span>
<span class="token punctuation">]</span>
<span class="token comment">// 以Array.prototype为原型创建arrMethods对象,并将其暴露</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> arrMethods <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>arrayPrototype<span class="token punctuation">)</span>

methodNames<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">methodName</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 备份原来的方法</span>
    <span class="token keyword">const</span> originMethod <span class="token operator">=</span> arrayPrototype<span class="token punctuation">[</span>methodName<span class="token punctuation">]</span>
    <span class="token comment">// 定义新的方法</span>
    <span class="token function">def</span><span class="token punctuation">(</span>arrMethods<span class="token punctuation">,</span>methodName<span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// 重写数组操作方法使其能被监测</span>
        <span class="token comment">// 调用原生方法操作数据</span>
        <span class="token function">originMethod</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span>arguments<span class="token punctuation">)</span>
        <span class="token comment">/* 
            因为push/splice/unshift可以向数组中插入数据，因此也需要对这些新添加的数据进行observe监测
            ，因此需要拿到__ob__属性对应的实例，在该实例身上有observeArray方法

            数组对象肯定不是最高层，最高层不能是数组，
            例如main中obj.g是数组，因此第一次遍历的时候g已经被添加了__ob__属性
        */</span>
       <span class="token comment">// 取出数组身上的ob</span>
    
       <span class="token keyword">const</span> ob <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>__ob__
       <span class="token comment">// arguments是一个类数组，没有数组的方法，将其转换一下</span>
       <span class="token keyword">let</span> Arguments <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>arguments<span class="token punctuation">]</span>
       <span class="token comment">// 存储不同方法插入的新项</span>
       <span class="token keyword">let</span> insertItems <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>

        <span class="token keyword">switch</span><span class="token punctuation">(</span>methodName<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">case</span> <span class="token string">&#39;push&#39;</span><span class="token operator">:</span>
            <span class="token keyword">case</span> <span class="token string">&#39;unshift&#39;</span><span class="token operator">:</span>
                insertItems <span class="token operator">=</span> arguments
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token keyword">case</span> <span class="token string">&#39;splice&#39;</span><span class="token operator">:</span>
                <span class="token comment">// splice语法： splice(下标，个数，插入新项)</span>
                insertItems <span class="token operator">=</span> Arguments<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 判断有没有需要插入的新项</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>insertItems<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token comment">// 有，则对其进行检测</span>
            ob<span class="token punctuation">.</span><span class="token function">observeArray</span><span class="token punctuation">(</span>insertItems<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Observer类</li></ul><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">//目的： 用于将一个普通的object对象的全部属性转换为响应式数据</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> arrMethods <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./array&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> defineReactive <span class="token keyword">from</span> <span class="token string">&quot;./defineReactive&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> def <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./utils&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">Observer</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;我是Observer&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 为obj添加__ob__属性，值为Observer类的实例（this）,并不可枚举</span>
    <span class="token function">def</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">&quot;__ob__&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 是数组对象的话就要修改其原型指向，使其优先调用修改后的方法</span>
      Object<span class="token punctuation">.</span><span class="token function">setPrototypeOf</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> arrMethods<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 再对数组内部进行遍历，转换响应式</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">observeArray</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">walk</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// object的遍历</span>
  <span class="token function">walk</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> item <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 将属性转换为响应式</span>
      <span class="token function">defineReactive</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 数组的遍历</span>
  <span class="token function">observeArray</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> l <span class="token operator">=</span> obj<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> l<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 逐项observe</span>
        <span class="token function">observe</span><span class="token punctuation">(</span>obj<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h2 id="依赖收集" tabindex="-1"><a class="header-anchor" href="#依赖收集" aria-hidden="true">#</a> 依赖收集</h2><ul><li><strong>定义</strong>：需要用到数据的地方，称为<strong>依赖</strong></li><li><strong>发展历程：</strong><ul><li>Vue1.x, <strong>细粒度</strong>依赖，即用到数据的<strong>DOM</strong>都是依赖</li><li>Vue2.x，<strong>中等粒度</strong>依赖，即用到数据的<strong>组件</strong>是依赖</li></ul></li><li><strong>发生位置：</strong><ul><li>在<strong>getter</strong>中<strong>收集</strong>依赖</li><li>在<strong>setter</strong>中<strong>触发</strong>依赖</li></ul></li></ul></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: 1034668900@qq.com">FengCh</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app-24212b55.js" defer></script>
  </body>
</html>
